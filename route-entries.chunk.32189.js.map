{"version":3,"sources":["webpack:///route-entries.chunk.32189.js","webpack:///./routes/entries/index.js"],"names":["webpackJsonp","VCKE","module","__webpack_exports__","__webpack_require__","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","TypeError","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","__WEBPACK_IMPORTED_MODULE_0_preact__","__WEBPACK_IMPORTED_MODULE_1__components_Traverse__","n","__WEBPACK_IMPORTED_MODULE_2_preact_router_match__","__WEBPACK_IMPORTED_MODULE_3__utils_date__","__WEBPACK_IMPORTED_MODULE_4_unistore_preact__","__WEBPACK_IMPORTED_MODULE_5__utils_questions__","Entries","_temp","_this","_ret","_len","arguments","length","args","Array","_key","this","_Component","apply","concat","state","years","question","getData","questions","entries","props","questionId","db","getTrackingQuestions","getAll","find","x","id","filter","isAnswerValid","reduce","current","entry","date","dateString","year","substring","push","parse","keys","forEach","sort","sortDates","setState","componentDidMount","render","a","b","Number","class","title","className","map","key","ymd","href","url","shortDate","Component","connect"],"mappings":"AAAAA,cAAc,IAERC,KACA,SAAUC,EAAQC,EAAqBC,GAE7C,YAeA,SAASC,GAA2BC,EAAMC,GAAQ,IAAKD,EAAQ,KAAM,IAAIE,gBAAe,4DAAgE,QAAOD,GAAyB,gBAATA,IAAqC,kBAATA,GAA8BD,EAAPC,EAElO,QAASE,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIC,WAAU,iEAAoED,GAAeD,GAASG,UAAYC,OAAOC,OAAOJ,GAAcA,EAAWE,WAAaG,aAAeC,MAAOP,EAAUQ,YAAY,EAAOC,UAAU,EAAMC,cAAc,KAAeT,IAAYG,OAAOO,eAAiBP,OAAOO,eAAeX,EAAUC,GAAcD,EAASY,UAAYX,GAhBjeG,OAAOS,eAAepB,EAAqB,cAAgBc,OAAO,GAC7C,IAAIO,GAAuCpB,EAAoB,QAE3DqB,GAD+CrB,EAAoBsB,EAAEF,GAChBpB,EAAoB,SACzEuB,EAAoDvB,EAAoB,QAExEwB,GAD4DxB,EAAoBsB,EAAEC,GACtCvB,EAAoB,SAChEyB,EAAgDzB,EAAoB,QAEpE0B,GADwD1B,EAAoBsB,EAAEG,GAC7BzB,EAAoB,SCRxF2B,E,YD2BJ,QAASA,KAKP,IAAK,GAJDC,GAAOC,EAAOC,EAITC,EAAOC,UAAUC,OAAQC,EAAOC,MAAMJ,GAAOK,EAAO,EAAGA,EAAOL,EAAMK,IAC3EF,EAAKE,GAAQJ,UAAUI,EAGzB,OAAeR,GAASC,EAAQ5B,EAA2BoC,KAAMC,EAAWnC,KAAKoC,MAAMD,GAAaD,MAAMG,OAAON,KAAiBL,ECnCpIY,OACEC,SACAC,a,EAOFC,QAAU,sDAIFC,EACAC,EACAH,EAIAD,CARN,OAFQ,GACmB,EAAKK,MAAxBC,EADA,EACAA,WAAYC,EADZ,EACYA,GACfD,EAEa,gBAAME,YAAqBD,IAA3B,qBACF,MADVJ,GAAY,EACF,gBAAMI,EAAGE,OAAO,oBAAhB,qBAGhB,MAHML,GAAU,GACVH,EAAWE,EAAUO,KAAK,SAAAC,GAAA,MAAKA,GAAEC,KAAON,MAIxCN,EAAQI,EACXS,OAAO,SAAAF,GAAA,MAAKA,GAAEL,aAAe,EAAKD,MAAMC,aACxCO,OAAOC,KACPC,OAAO,SAACC,EAASC,GAChB,GAAMC,GAAOD,EAAME,WACbC,EAAOF,EAAKG,UAAU,EAAG,EAG/B,OAFKL,GAAQI,KAAOJ,EAAQI,OAC5BJ,EAAQI,GAAME,KAAKC,YAAML,IAClBF,OAGXhD,OAAOwD,KAAKxB,GAAOyB,QAAQ,SAAAL,GACzBpB,EAAMoB,GAAMM,KAAKC,OAGnB,EAAKC,UAAW5B,QAAOC,aApBP,KAGD,IAHC,0BADE,0BAFD,ODwBVb,E,SAqGT,MAhHAzB,GAAUsB,EAASW,GA8DnBX,EAAQlB,UCjFR8D,kB,WACElC,KAAKO,WDoFPjB,EAAQlB,UCrDR+D,O,cAA4C,GAAnCxB,GAAmC,EAAnCA,WAAgBN,EAAmB,EAAnBA,MAAOC,EAAY,EAAZA,SACxBuB,EAAOxD,OAAOwD,KAAKxB,EAGzB,OAFAwB,GAAKE,KAAK,SAACK,EAAGC,GAAJ,MAAUC,QAAOD,GAAKC,OAAOF,KAGrC,mBAAKG,MAAM,sBACT,YAAC,KACCC,MAAOlC,EAASkC,OAAS,iBACzBC,UAAU,qBAEXZ,EAAKjC,OACFiC,EAAKa,IAAI,SAAAjB,GAAA,MACP,oBAAKkB,IAAKlB,EAAMc,MAAM,eACpB,sBAAKd,GACL,kBAAIc,MAAM,uCACPlC,EAAMoB,GAAMiB,IAAI,SAAAnB,GAAA,MACf,mBAAIoB,IAAKC,YAAIrB,IACX,YAAC,QAAKsB,KAAMC,YAAIvB,EAAMZ,GAAa4B,MAAM,UACtCQ,YAAUxB,WAOvB,OD0EHjC,GCzIa0D,YAqEPC,6BAAQ,MAAM3D","file":"route-entries.chunk.32189.js","sourcesContent":["webpackJsonp([9],{\n\n/***/ \"VCKE\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_preact__ = __webpack_require__(\"KM04\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_preact___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_preact__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__components_Traverse__ = __webpack_require__(\"db16\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_preact_router_match__ = __webpack_require__(\"sw5u\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_preact_router_match___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_preact_router_match__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_date__ = __webpack_require__(\"8EZx\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_unistore_preact__ = __webpack_require__(\"o6ac\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_unistore_preact___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_unistore_preact__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_questions__ = __webpack_require__(\"b1q8\");\n\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\n\n\n\n\nvar Entries = function (_Component) {\n  _inherits(Entries, _Component);\n\n  function Entries() {\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Entries);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, _Component.call.apply(_Component, [this].concat(args))), _this), _this.state = {\n      years: {},\n      question: {}\n    }, _this.getData = function () {\n      return new Promise(function ($return, $error) {\n        var _this$props, questionId, db, questions, entries, question, years;\n\n        _this$props = _this.props, questionId = _this$props.questionId, db = _this$props.db;\n\n        if (!questionId) return $return();\n\n        return Promise.resolve(Object(__WEBPACK_IMPORTED_MODULE_5__utils_questions__[\"b\" /* getTrackingQuestions */])(db)).then(function ($await_1) {\n          try {\n            questions = $await_1;\n            return Promise.resolve(db.getAll('trackingEntries')).then(function ($await_2) {\n              try {\n                entries = $await_2;\n                question = questions.find(function (x) {\n                  return x.id === questionId;\n                });\n\n                if (!question) return $return();\n\n                years = entries.filter(function (x) {\n                  return x.questionId === _this.props.questionId;\n                }).filter(__WEBPACK_IMPORTED_MODULE_5__utils_questions__[\"c\" /* isAnswerValid */]).reduce(function (current, entry) {\n                  var date = entry.dateString;\n                  var year = date.substring(0, 4);\n                  if (!current[year]) current[year] = [];\n                  current[year].push(Object(__WEBPACK_IMPORTED_MODULE_3__utils_date__[\"h\" /* parse */])(date));\n                  return current;\n                }, {});\n\n                Object.keys(years).forEach(function (year) {\n                  years[year].sort(__WEBPACK_IMPORTED_MODULE_3__utils_date__[\"k\" /* sortDates */]);\n                });\n\n                _this.setState({ years: years, question: question });\n                return $return();\n              } catch ($boundEx) {\n                return $error($boundEx);\n              }\n            }, $error);\n          } catch ($boundEx) {\n            return $error($boundEx);\n          }\n        }, $error);\n      });\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  Entries.prototype.componentDidMount = function componentDidMount() {\n    this.getData();\n  };\n\n  Entries.prototype.render = function render(_ref, _ref2) {\n    var questionId = _ref.questionId;\n    var years = _ref2.years,\n        question = _ref2.question;\n\n    var keys = Object.keys(years);\n    keys.sort(function (a, b) {\n      return Number(b) - Number(a);\n    });\n\n    return Object(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n      'div',\n      { 'class': 'wrap lift-children' },\n      Object(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(__WEBPACK_IMPORTED_MODULE_1__components_Traverse__[\"a\" /* default */], {\n        title: question.title || 'Personal stats',\n        className: 'traverse--center'\n      }),\n      keys.length ? keys.map(function (year) {\n        return Object(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n          'div',\n          { key: year, 'class': 'center mt20' },\n          Object(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n            'h2',\n            null,\n            year\n          ),\n          Object(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n            'ul',\n            { 'class': 'year-overview year-overview--center' },\n            years[year].map(function (date) {\n              return Object(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                'li',\n                { key: Object(__WEBPACK_IMPORTED_MODULE_3__utils_date__[\"m\" /* ymd */])(date) },\n                Object(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                  __WEBPACK_IMPORTED_MODULE_2_preact_router_match__[\"Link\"],\n                  { href: Object(__WEBPACK_IMPORTED_MODULE_3__utils_date__[\"l\" /* url */])(date, questionId), 'class': 'button' },\n                  Object(__WEBPACK_IMPORTED_MODULE_3__utils_date__[\"j\" /* shortDate */])(date)\n                )\n              );\n            })\n          )\n        );\n      }) : null\n    );\n  };\n\n  return Entries;\n}(__WEBPACK_IMPORTED_MODULE_0_preact__[\"Component\"]);\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Object(__WEBPACK_IMPORTED_MODULE_4_unistore_preact__[\"connect\"])('db')(Entries));\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// route-entries.chunk.32189.js","import { h, Component } from 'preact';\nimport Traverse from '../../components/Traverse';\nimport { Link } from 'preact-router/match';\nimport { parse, ymd, url, sortDates, shortDate } from '../../utils/date';\nimport { connect } from 'unistore/preact';\nimport { getTrackingQuestions, isAnswerValid } from '../../utils/questions';\n\nclass Entries extends Component {\n  state = {\n    years: {},\n    question: {},\n  };\n\n  componentDidMount() {\n    this.getData();\n  }\n\n  getData = async () => {\n    const { questionId, db } = this.props;\n    if (!questionId) return;\n\n    const questions = await getTrackingQuestions(db);\n    const entries = await db.getAll('trackingEntries');\n    const question = questions.find(x => x.id === questionId);\n\n    if (!question) return;\n\n    const years = entries\n      .filter(x => x.questionId === this.props.questionId)\n      .filter(isAnswerValid)\n      .reduce((current, entry) => {\n        const date = entry.dateString;\n        const year = date.substring(0, 4);\n        if (!current[year]) current[year] = [];\n        current[year].push(parse(date));\n        return current;\n      }, {});\n\n    Object.keys(years).forEach(year => {\n      years[year].sort(sortDates);\n    });\n\n    this.setState({ years, question });\n  };\n\n  render({ questionId }, { years, question }) {\n    const keys = Object.keys(years);\n    keys.sort((a, b) => Number(b) - Number(a));\n\n    return (\n      <div class=\"wrap lift-children\">\n        <Traverse\n          title={question.title || 'Personal stats'}\n          className=\"traverse--center\"\n        />\n        {keys.length\n          ? keys.map(year => (\n              <div key={year} class=\"center mt20\">\n                <h2>{year}</h2>\n                <ul class=\"year-overview year-overview--center\">\n                  {years[year].map(date => (\n                    <li key={ymd(date)}>\n                      <Link href={url(date, questionId)} class=\"button\">\n                        {shortDate(date)}\n                      </Link>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            ))\n          : null}\n      </div>\n    );\n  }\n}\n\nexport default connect('db')(Entries);\n\n\n\n// WEBPACK FOOTER //\n// ./routes/entries/index.js"],"sourceRoot":""}